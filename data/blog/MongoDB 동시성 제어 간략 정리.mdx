---
title: MongoDB ë™ì‹œì„± ì œì–´
date: '2023-04-16'
tags: ['MongoDB', 'ë™ì‹œì„±', 'ë™ì‹œì„± ì œì–´', 'ë‚™ê´€ì  ì ê¸ˆ', 'ì ê¸ˆ', 'íŠ¸ëœì­ì…˜', 'ê²©ë¦¬ ìˆ˜ì¤€']
draft: false
summary: 'ë™ì‹œì„±ì œì–´ì™€ ê´€ë ¨ëœ ì´ë¡ ê³¼ RDBì™€ MongoDBì˜ ë™ì‹œì„± ì œì–´ë¥¼ ë¹„êµë¶„ì„'
---

# ê°œìš”

<TOCInline toc={props.toc} exclude="ê°œìš”" toHeading={3} />
ë™ì‹œì„± ì œì–´ëŠ” ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ì‘ì—…ì„ ì„±ê³µì ìœ¼ë¡œ ë§ˆì¹  ìˆ˜ ìˆë„ë¡ ì‹¤í–‰ ìˆœì„œë¥¼ ì œì–´í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. ì´ëŠ”
ë°ì´í„°ì˜ ë¬´ê²°ì„±ê³¼ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•œ ìš”ì†Œì´ë‹¤. ë§Œì•½, ì´ëŸ¬í•œ ë™ì‹œì„± ì œì–´ì— ì‹ ê²½ ì“°ì§€ ì•Šê³ 
íŠ¸ëœì­ì…˜ì„ ì„¤ê³„í•œë‹¤ë©´ íŠ¸ëœì­ì…˜ì˜ ê²°ê³¼ê°€ ìœ ì‹¤ë˜ê±°ë‚˜ íŠ¸ëœì­ì…˜ ê°„ì˜ ê°„ì„­ì´ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

ì´ ê¸€ì—ì„œëŠ” ì „í†µì ì¸ ë°ì´í„°ë² ì´ìŠ¤ì¸ RDBì™€ NoSQL ì¤‘ í•˜ë‚˜ì¸ MongoDBì˜ ë™ì‹œì„± ì œì–´ì— ëŒ€í•´ ë¹„êµí•˜
ë©´ì„œ ì´í•´í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„œ ì¼ë‹¨ íŠ¸ëœì­ì…˜ê³¼ ì ê¸ˆì— ëŒ€í•´ ê°„ë‹¨í•˜ê²Œ ì§šê³  ë„˜ì–´ê°€ì.

## íŠ¸ëœì­ì…˜

íŠ¸ëœì­ì…˜ì€ ë°ì´í„°ë² ì´ìŠ¤ ìƒì—ì„œ ì²˜ë¦¬ë˜ëŠ” ì‘ì—…ì˜ ìµœì†Œ ë‹¨ìœ„ì´ë‹¤. ì¦‰, í•´ë‹¹ íŠ¸ëœì­ì…˜ì˜
ì‘ì—…ì´ ë‚´ë¶€ì ìœ¼ë¡œ `T1`, `T2`, `T3`ê³¼ ê°™ì´ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤ë©´, ëª¨ë“  ì‘ì—…ì´ ì²˜ë¦¬ë˜ì–´ì•¼ë§Œ í•´ë‹¹
íŠ¸ëœì­ì…˜ì˜ ì‘ì—… ì‚¬í•­ë“¤ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤. ì‘ì—… ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•œë‹¤ë©´?
ë¬¼ë¡  ëª¨ë“  ì‘ì—… ì‚¬í•­ë“¤ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜ë˜ë©´ ì•ˆëœë‹¤.
ì´ëŸ¬í•œ ì„±ì§ˆë“¤ì„ ëª¨ì•„ì„œ [ACID](https://ko.wikipedia.org/wiki/ACID)ë¼ê³  í•œë‹¤.
ë™ì‹œì„± ì œì–´ê°€ ì˜ ëœ ì‹œìŠ¤í…œì€ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” íŠ¸ëœì­ì…˜ì˜ ì„±ì§ˆì„ ìµœëŒ€í•œ ë³´ì¥í•˜ë©´ì„œ ê°€ìš©ì„±ê¹Œì§€
ìƒê°í•´ì•¼ í•œë‹¤.

# ì ê¸ˆ

ìˆ˜ì²œ, ìˆ˜ë§Œ ëª…ì˜ ì‚¬ìš©ìê°€ ì ‘ê·¼í•˜ëŠ” ê·œëª¨ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ê°™ì€ ìì›ì— ëŒ€í•´ ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ì ‘ê·¼í•˜ëŠ” ê²½ìš°ê°€ ë¶ˆê°€í”¼í•˜ê²Œ
ì¼ì–´ë‚œë‹¤. ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ë™ì¼í•œ ìì›ì— ì ‘ê·¼í•˜ëŠ” ìš”ì²­ë“¤ì„ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•œ ì ê¸ˆì˜ ì¢…ë¥˜ëŠ”
ëŒ€í‘œì ìœ¼ë¡œ 2ê°€ì§€ê°€ ìˆë‹¤.

## ê³µìœ  ì ê¸ˆ

ê³µìœ  ì ê¸ˆì€ ì ê²¨ìˆëŠ” ë¡œìš°ë‚˜ í…Œì´ë¸”ì„ ì½ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ê·¸ë˜ì„œ `Read Lock`ì´ë¼ê³ ë„ í•œë‹¤.
í•˜ë‚˜ì˜ ìì›ì— ëŒ€í•œ ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì€ ê³µìœ  ì ê¸ˆì„ ìš”ì²­í•˜ì—¬ í•´ë‹¹ ìì›ì„ ì½ì„ ìˆ˜ ìˆë‹¤. ê³µìœ  ì ê¸ˆì´ ìˆëŠ” í•œ
í•´ë‹¹ ìì›ì€ ìˆ˜ì •ë  ìˆ˜ ì—†ë‹¤.

## ë°°íƒ€ ì ê¸ˆ

ë°°íƒ€ ì ê¸ˆì€ ê° ë¡œìš°ë‚˜ í…Œì´ë¸”ì„ ì™„ì „íˆ ì ê·¸ê³  ë…ë¦½ì ìœ¼ë¡œ ìˆ˜ì •ë ìˆ˜ ìˆë„ë¡ í•œë‹¤.
íŠ¹ì • ì‹œì ì— íŠ¹ì • ìì›ì— ëŒ€í•œ ë°°íƒ€ ë½ íšë“ì€ í•œ íŠ¸ëœì­ì…˜ë§Œ ê°€ëŠ¥í•˜ë‹¤. ë˜í•œ, ë°°íƒ€ ë½ì´
ì¡´ì¬í•˜ëŠ” ê°™ì€ ìì›ì— ë°°íƒ€ ë½ì„ íšë“í•˜ë ¤ëŠ” ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ëŠ” í•´ë‹¹ ì ê¸ˆì´
ë°˜í™˜ë˜ê¸° ì „ê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤. ë§Œì•½ í•´ë‹¹ ìì›ì— ëŒ€í•´ ê³µìœ  ë½ì„ ê°–ê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ìˆë‹¤ë©´
ë°°íƒ€ ë½ ìš”ì²­ì€ ê±°ë¶€ëœë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ ë°°íƒ€ ë½ì´ ê±¸ë ¤ ìˆëŠ” ìì›ì— ëŒ€í•´ ê³µìœ  ë½ì„ íšë“í•  ìˆ˜ ì—†ë‹¤.

## ë¹„ê´€ì  ë™ì‹œì„± ì œì–´ì™€ ë‚™ê´€ì  ë™ì‹œì„± ì œì–´

ìœ„ì˜ ì ê¸ˆ ì¢…ë¥˜ë¥¼ ì‚¬ìš©í•´ì„œ ìì›ì— ëŒ€í•œ ì ê¸ˆì„ ê±¸ê³ , í•´ë‹¹ ì ê¸ˆì— ë”°ë¼ íŠ¸ëœì­ì…˜ë“¤ì˜
ì‘ì—…ì„ ì²˜ë¦¬í•˜ê²Œ ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ê°€ íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ì†ë„ê°€ ë–¨ì–´ì§€ê²Œ ëœë‹¤. ë°‘ì—
ì„¤ëª…í•  ë™ì‹œì„± ì œì–´ ë°©ì‹ë“¤ì€ ì ê¸ˆì„ ì œê±°í•˜ê±°ë‚˜ ê¸°ì¤€ì„ ë‚®ì¶˜ í›„ íŠ¸ëœì­ì…˜ì˜ ì²˜ë¦¬ìœ¨ì„ ì±™ê¸°ëŠ” ë°©í–¥ìœ¼ë¡œ ì„¤ê³„ëœ
ë™ì‹œì„± ì œì–´ ë°©ì‹ë“¤ì´ë‹¤.

### ë‚™ê´€ì  ë™ì‹œì„± ì œì–´

- ë‚™ê´€ì  ì ê¸ˆì€ í•˜ë‚˜ì˜ ìì›ì— ë™ì‹œì— ì—¬ëŸ¬ê°œì˜ íŠ¸ëœì­ì…˜ì´ ì¼ì–´ë‚˜ë©´ ì„œë¡œ ê°„ì„­í•˜ì§€ ì•Šê³ ë„ ë•Œë•Œë¡œ ì™„ìˆ˜ ë  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.
- ê·¸ëŸ¬í•œ ì¼í™˜ìœ¼ë¡œ íŠ¸ëœì­ì…˜ë“¤ì€ ìì›ì— ëŒ€í•œ ì ê¸ˆì„ íšë“í•˜ì§€ ì•Šì€ ì±„ ìì›ì„ ì‚¬ìš©í•œë‹¤. ì¦‰ ê°™ì€ ìì›ì— ëŒ€í•œ
  ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì ‘ê·¼ì´ í—ˆìš©ëœë‹¤.
- íŠ¸ëœì­ì…˜ì€ ì»¤ë°‹í•˜ê¸° ì „ì— ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ìì›ì„ ìˆ˜ì •í•˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
- ìœ„ ê²€ì‚¬ ë„ì¤‘ ì¶©ëŒë˜ëŠ” ìˆ˜ì •ì´ í™•ì¸ë˜ë©´ íŠ¸ëœì­ì…˜ì˜ ì‘ì—…ì‚¬í•­ì„ ë¡¤ë°±í•˜ê³  ì¶”í›„ ì¬ì‹œë„ í•  ìˆ˜ ìˆë‹¤.

ë‚™ê´€ì  ì ê¸ˆì€ ë°ì´í„° ê²½í•©ì´ ë°œìƒí•˜ëŠ” ë¹ˆë„ê°€ ë‚®ì€ ê²½ìš° ê³ ë ¤í•´ë³¼ë§Œ í•˜ë‹¤.
ê²½í•©ì´ ì ì„ ê²½ìš°, ì ê¸ˆì„ ê´€ë¦¬í•˜ëŠ” ë¹„ìš© ì—†ì´, ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì ê¸ˆ ë°˜í™˜ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¼ ì—†ì´
íŠ¸ëœì­ì…˜ ìˆ˜í–‰ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë†’ì€ ì²˜ë¦¬ìœ¨ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.

### ë¹„ê´€ì  ë™ì‹œì„± ì œì–´

- ë¹„ê´€ì  ì ê¸ˆì€ ë‚™ê´€ì  ì ê¸ˆ ë°©ì‹ê³¼ ë°˜ëŒ€ë¡œ, ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ìˆ˜í–‰ë  ê²½ìš° ì„œë¡œ ê°„ì„­í•˜ëŠ” ìƒí™© ë°œìƒí•˜ì§€ ì•Šë”ë¼ë„
  ì¼ë‹¨ ì ê¸ˆì„ í†µí•´ ì ‘ê·¼ì„ ë§‰ëŠ”ë‹¤.
- íŠ¸ëœì­ì…˜ë“¤ì€ ìì›ì— ì ‘ê·¼í•˜ë ¤ë©´ ì ê¸ˆì„ íšë“í•´ì•¼ í•œë‹¤.
- ì ê¸ˆì„ íšë“í•˜ì§€ ëª»í•œ íŠ¸ëœì­ì…˜ì€ ì ê¸ˆì´ ë°˜í™˜ë˜ê¸°ê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.

ë¹„ê´€ì  ì ê¸ˆì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì²˜ë¦¬ìœ¨ì€ ë‚®ì¶œ ìˆ˜ ìˆìœ¼ë‚˜ ë°ë“œë½ ìƒí™©ì—ì„œ íŠ¸ëœì­ì…˜ë“¤ì„ ì œì–´í•˜ê³ 
ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ ë°ì´í„°ë“¤ì˜ ë¬´ê²°ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ê·¸ëŸ¬ë‚˜ ì¶”ê°€ì ìœ¼ë¡œ
ë™ì‹œì„±ì„ í™•ë³´í•˜ê¸° ìœ„í•´ íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ 4 ë‹¨ê³„ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ëŠ” RDBì—ì„œ ì‚¬ìš©ë˜ëŠ”
ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤.

1. Read Uncommited

   SELECT ì‹œ ë°ì´í„°ì— ê³µìœ  ì ê¸ˆì´ ê±¸ë¦¬ì§€ ì•ŠëŠ”ë‹¤.
   ì»¤ë°‹ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¥¼ ì½ì‘ ê²½ìš°ê°€ ë°œìƒí•œë‹¤. ( Dirty Read )

2. Read Commited

   íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ëœ ë°ì´í„°ë§Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì½ì„ ìˆ˜ ìˆë‹¤. ( Dirty Read ë°©ì§€ )
   ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ë¨¼ì € ì™„ë£Œëœ ê²½ìš°, ì´ì „ì— ì½ì€ ìì›ì„ ë‹¤ì‹œ ì½ì—ˆì„ ë•Œ
   ë‚´ìš©ì´ ë‹¤ë¥¸ (Non-Repeatable Read)ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

3. Repeatable Read

   ì»¤ë°‹í•œ ë°ì´í„° ìˆ˜ì •, ì‚­ì œ ì‚¬í•­ì´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì½íˆì§€ ì•Šë„ë¡ í•œë‹¤.
   ì´ë¥¼ í†µí•´ Non-Repeatable Readê°€ ë°©ì§€ëœë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ **ì‚½ì…**ëœ ë°ì´í„°ëŠ”
   í‘œì‹œë  ìˆ˜ ìˆëŠ” ë¬¸ì œê°€ ìˆë‹¤. (Phantom Read)

4. Serializable

   íŠ¸ëœì­ì…˜ì˜ ì‹œì‘ë¶€í„° ëê¹Œì§€ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ìˆ˜ì •/ì‚­ì œ/ì‚½ì… ì‘ì—…ì‚¬í•­ì´ ì˜í–¥ë¥´ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

# MongoDBì˜ ë™ì‹œì„± ì œì–´

MongoDBëŠ” ë™ì‹œì„±ì„ ì–´ë–»ê²Œ ì œì–´í• ê¹Œ? MongoDB 3.2 ë²„ì „ë¶€í„° ê¸°ë³¸ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ”
Wired Tiger ì—”ì§„ì€ ë‚™ê´€ì  ë™ì‹œì„± ì œì–´ë¥¼ ì‚¬ìš©í•˜ë©° ì¶©ëŒì´ ì‹¤ì œë¡œ ë°œìƒí•˜ê¸° ì „ê¹Œì§€
ì¶©ëŒ ê²€ì‚¬ë¥¼ ì§€ì—°ì‹œí‚¨ í›„, ì¶©ëŒì´ ë°œìƒí–ˆë‹¤ë©´ ê´€ë ¨ ì‘ì—…ë“¤ ì¤‘ í•˜ë‚˜ë¥¼ ì¤‘ë‹¨í•˜ê³  ì¬ì‹œë„í•œë‹¤.

## MongoDBì˜ ì ê¸ˆ

### ì ê¸ˆ ìˆ˜ì¤€

1. ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨
2. ì»¬ë ‰ì…˜ ë ˆë²¨
3. ë„íë¨¼íŠ¸ ë ˆë²¨ (WiredTiger ì—”ì§„ ê¸°ì¤€)

### ì ê¸ˆ ì¢…ë¥˜

- S

  ê³µìœ  ì ê¸ˆê³¼ ê°™ì´ ì½ê¸°ë¥¼ ìœ„íŒ ì ê¸ˆì´ë‹¤.

- IS

  ì„¸ë¶„í™”ëœ ê³µìœ  ì ê¸ˆìœ¼ë¡œ ìì›ì„ ì½ìœ¼ë ¤ëŠ” ì˜ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. íŠ¹ì • ë ˆë²¨ì˜ ìì›ì— ëŒ€í•´
  S ëª¨ë“œë¡œ ì ê¸€ ê²½ìš°, í•´ë‹¹ ìì›ë³´ë‹¤ ë†’ì€ ë ˆë²¨ì˜ ìì›ë“¤ì€ IS ëª¨ë“œë¡œ ì êµ¬ì–´ì•¼ í•œë‹¤.
  ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ë¬¸ì„œì— ëŒ€í•œ S ì ê¸ˆì„ íšë“í–ˆë‹¤ë©´, ì»¬ë ˆì…˜, ë°ì´í„°ë² ì´ìŠ¤ëŠ” IS ëª¨ë“œë¡œ ì ê¸°ê²Œ ëœë‹¤.

- X

  ë°°íƒ€ ì ê¸ˆê³¼ ê°™ì´ ì“°ê¸°ë¥¼ ìœ„í•œ ì ê¸ˆì´ë‹¤.

- IX

  ì„¸ë¶„í™”ëœ ë°°íƒ€ ì ê¸ˆìœ¼ë¡œ ìì›ì„ ì“°ë ¤ëŠ” ì˜ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. íŠ¹ì • ë ˆë²¨ì˜ ìì›ì— ëŒ€í•´
  X ëª¨ë“œë¡œ ì ê¸€ ê²½ìš°, í•´ë‹¹ ìì›ë³´ë‹¤ ë†’ì€ ë ˆë²¨ì˜ ìì›ë“¤ì€ IX ëª¨ë“œë¡œ ì êµ¬ì–´ì•¼ í•œë‹¤.
  ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ë¬¸ì„œì— ëŒ€í•œ X ì ê¸ˆì„ íšë“í–ˆë‹¤ë©´, ì»¬ë ˆì…˜, ë°ì´í„°ë² ì´ìŠ¤ëŠ” IX ëª¨ë“œë¡œ ì ê¸°ê²Œ ëœë‹¤.

ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ëŠ” IX ì™€ IS ëª¨ë“œë¡œ ë™ì‹œì— ì ê¸€ ìˆ˜ ìˆì°Œë§Œ, X ëª¨ë“œëŠ” ê³µì¡´í•  ìˆ˜ ì—†ë‹¤.
S ëª¨ë“œ ì ê¸ˆì€ IS ì ê¸ˆí•˜ê³ ë§Œ ê³µì¡´í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚´í´ë³´ì.

1. X ëª¨ë“œ ì ê¸ˆìœ¼ë¡œ ë¬¸ì„œ1ì„ ì ê·¼ë‹¤.
2. ë¬¸ì„œ 1ì˜ ì»¬ë ‰ì…˜1ì„ IX ëª¨ë“œë¡œ ì ê·¼ë‹¤.
3. ì»¬ë ‰ì…˜1ì˜ ë°ì´í„°ë² ì´ìŠ¤1ì„ IX ëª¨ë“œë¡œ ì ê·¼ë‹¤.

ë§Œì•½ ë¬¸ì„œ 2ë¥¼ S ì ê¸ˆìœ¼ë¡œ ì ê·¼ë‹¤ë©´?

1. ë¬¸ì„œ 2ë¥¼ S ëª¨ë“œë¡œ ì ê·¼ë‹¤.
2. ë¬¸ì„œ 2ì˜ ìƒìœ„ ìì›ì¸ ì»¬ë ‰ì…˜ 1ì€ IS ëª¨ë“œë¡œ ì ê·¼ë‹¤.
3. ì»¬ë ‰ì…˜ 1ì˜ ìƒìœ„ ìì›ì¸ ë°ì´í„°ë² ì´ìŠ¤ 1ì€ IS ëª¨ë“œë¡œ ì ê·¼ë‹¤.

ì´ ê²½ìš°ëŠ” ì ê¸ˆëª¨ë“œê°€ ì„œë¡œ ê³µì¡´ê°€ëŠ¥í•œ ê²½ìš°ì´ë‹¤.

- ë°ì´í„°ë² ì´ìŠ¤ (IS, IX) - ê³µì¡´ê°€ëŠ¥ ğŸŸ¢
- ì»¬ë ‰ì…˜ (IS, IX) - ê³µì¡´ê°€ëŠ¥ ğŸŸ¢
- ë¬¸ì„œ 1(X), ë¬¸ì„œ 2(S) - ê³µì¡´ê°€ëŠ¥ ğŸŸ¢

ì—¬ê¸°ì„œ ë¬¸ì„œ 1ì€ ì•ìœ¼ë¡œ ì ê¸ˆì„ ë°˜í™˜í•˜ê¸° ì „ê¹Œì§€ ì–´ë– í•œ ì‘ì—…ë„ ì ê¸ˆì„ íšë“í•  ìˆ˜ ì—†ë‹¤.
ë¬¸ì„œ 2ëŠ” IS ì ê¸ˆì„ ì œì™¸í•œ ë‹¤ë¥¸ ì ê¸ˆì„ ìš”ì²­í•˜ëŠ” ì‘ì—…ì€ ì ê¸ˆì„ íšë“í•  ìˆ˜ ì—†ê²Œ ëœë‹¤.

í•´ë‹¹ ì ê¸ˆ ë°©ì‹ì— ëŒ€í•´ì„œ ëª½ê³ DBê°€ ë³„ë„ì˜ ìµœì í™” ì‘ì—…ì„ ì§„í–‰í•˜ê¸°ë„ í•œë‹¤.
ìš”ì²­ íì— ë‹¤ìŒê³¼ ê°™ì€ ì ê¸ˆì„ ìš”ì²­í•˜ëŠ” ì‘ì—…ì´ ìˆë‹¤ê³  í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤..

| ì ê¸ˆ | IS  | IS  | X   | X   | S   | IS  |
| ---- | --- | --- | --- | --- | --- | --- |
| ìˆœì„œ | 0   | 1   | 2   | 3   | 4   | 5   |

FIFO í ì•ˆì— í•´ë‹¹ ì‘ì—…ë“¤ì„ ìˆœì„œëŒ€ë¡œ ë„£ëŠ”ë‹¤ë©´, ì²˜ìŒ 0, 1ë²ˆì§¸ì˜ IS ì ê¸ˆ ì‘ì—…ë“¤ì€ ë¹ ë¥´ê²Œ ì²˜ë¦¬ ë  ê²ƒì´ë‹¤.
ê·¸ëŸ¬ë‚˜ ë’¤ ìª½ì˜ 4, 5ë²ˆì§¸ ë‘ S, IS ì ê¸ˆì„ íšë“í•˜ë ¤ëŠ” ìš”ì²­ ë‘ê°œëŠ”
2, 3ë²ˆì§¸ì˜ X ì ê¸ˆì„ íšë“í•´ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ë“¤ì´ ì¢…ë£Œë˜ì§€ ì•ŠëŠ” ì´ìƒ ì§€ì—°ëœë‹¤. ëª½ê³ DBëŠ” ì´ ê²½ìš°,
0, 1, 4, 5 ë²ˆì§¸ ìš”ì²­ë“¤ì„ ë¨¼ì € ì²˜ë¦¬í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ X ì ê¸ˆì¸ ì‘ì—…ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ S, IS ì ê¸ˆì´ í•„ìš”í•œ
ì‘ì—…ë“¤ì´ ë¬´í•œì • ê¸°ë‹¤ë¦¬ëŠ” ê²½ìš°ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

### Wired Tiger ì—”ì§„ì—ì„œì˜ ì ê¸ˆ ë™ì‘ ë°©ì‹

Writed Tiger ì—”ì§„ì€ ë‚™ê´€ì  ë™ì‹œì„± ì œì–´ë¥¼ ì‚¬ìš©í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ë‘ ì‘ì—…ê°„ì˜ ì¶©ëŒì´ ë°œìƒí•  ê²½ìš°
í•œ ì‘ì—…ì€ ì¶©ëŒì„ ì¼ìœ¼í‚¤ê³  Wried Tiger ì—”ì§„ì´ í•´ë‹¹ ì‘ì—…ì„ ì¬ì‹œë„ í•˜ê²Œ ëœë‹¤.

## MongoDBì˜ íŠ¸ëœì­ì…˜

MongoDBëŠ” ë¬¸ì„œì§€í–¥ ë°ì´í„°ë² ì´ìŠ¤ë‹¤. ê¶Œì¥ë˜ëŠ” ëª¨ë¸ë§ ë°©ì‹ì— ì¡°ì¸ì€ ì—†ë‹¤. ì™ ë§Œí•˜ë©´ í•˜ë‚˜ì˜ ë¬¸ì„œ ì•ˆì—
ê´€ë ¨ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ëª¨ì•„ ë†“ëŠ” ê²ƒì´ ì¢‹ë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ëŸ¬ê°€ì§€ ì œì•½ìœ¼ë¡œ ì¸í•´ í•˜ë‚˜ì˜ ë„íë¨¼íŠ¸ë¥¼
ì—¬ëŸ¬ ë„íë¨¼íŠ¸ë¡œ ë¶„ë¦¬í•´ì•¼ í•  ì¼ì´ ìƒê¸´ë‹¤. ê°œì¸ì ìœ¼ë¡  ì´ëŸ¬í•œ ìƒí™©ì´ ë°œìƒí•  ê±°ë¼ ì˜ˆìƒëœë‹¤ë©´ í•´ë‹¹ ë¶€ë¶„ì€
ê´€ê³„í˜• ë””ë¹„ë¥¼ ì¨ì•¼ í•œë‹¤ê³  ìƒê°í•˜ì§€ë§Œ, ìš”êµ¬ì‚¬í•­ì€ í•­ìƒ ë³€í•˜ë“¯ì´ ê²°êµ­ í˜„ì¬ ê°€ì§„ ì†”ë£¨ì…˜ìœ¼ë¡œ ìµœëŒ€í•œ ì˜ í•´ê²°í•´ì•¼ í•œë‹¤ê³ 
ìƒê°í•œë‹¤. ëª½ê³ ë””ë¹„ëŠ” ë¬¸ì„œ í•˜ë‚˜ì— ëŒ€í•œ ëª…ë ¹ì€ ì›ìì„±ì„ ë³´ì¥í•œë‹¤. ê·¸ë¦¬ê³ 
ë²„ì „ì´ ì—…ê·¸ë ˆì´ë“œ ë˜ë©´ì„œ ì§€ì›í•˜ëŠ” íŠ¸ëœì­ì…˜ì´ ëŠ˜ì–´ë‚¬ë‹¤.

- 4.0 ë²„ì „ë¶€í„°ëŠ” ë ˆí”Œë¦¬ì¹´ ì…‹ì— ë‹¤ì¤‘ ë¬¸ì„œ íŠ¸ëœì­ì…˜ì„ ì§€ì›í•œë‹¤.
- 4.2 ë²„ì „ë¶€í„°ëŠ” ë¶„ì‚° íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ì—¬ ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°ì—ì„œì˜ ë‹¤ì¤‘ ë¬¸ì„œ íŠ¸ëœì­ì…˜ì„ ì§€ì›í•œë‹¤.

ê·¸ëŸ¬ë‚˜ ë‹¤ì¤‘ ë¬¸ì„œ íŠ¸ëœì­ì…˜ì˜ ê²½ìš°, MongoDBì˜ ìì›ì„ ë” ë§ì´ ì†Œëª¨í•˜ê¸° ë•Œë¬¸ì—
ë¹„ì •ê·œí™”ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤ë©´ ëª¨ë¸ë§ì„ í†µí•´ ë¨¼ì € í•´ê²°í•˜ê³  ê·¸ê²Œ ì•ˆ ëœë‹¤ë©´ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê±¸ ê¶Œì¥í•˜ê³  ìˆë‹¤.

### MongoDB íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€

1. Read Uncomitted

   ì“°ê¸° ì‘ì—…ì˜ ì§„í–‰ ìƒí™©ì´ `ì˜ì†ì `ì´ì§€ ì•Šì•„ë„ í•´ë‹¹ ê²°ê³¼ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.
   ë‹¤ì¤‘ ë„íë¨¼íŠ¸ íŠ¸ëœì­ì…˜ì˜ ê²½ìš°, íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ëœë‹¤ë©´ í•´ë‹¹ íŠ¸ëœì­ì…˜ì´ ë³€ê²½í•œ ë°ì´í„°ê°€
   ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ë“¤ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•´ ì§„ë‹¤.

> ğŸ’¡ ëª½ê³  DBì—ì„œ ì˜ì†ì ì´ë¼ëŠ” ëœ»ì€ í•˜ë‚˜ì˜ mongod ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¼ ê²½ìš° í•´ë‹¹ ì„œë²„ì˜ ì €ë„ì—
> ì“°ê¸° ì—°ì‚°ì˜ ê²°ê³¼ê°€ ê¸°ë¡ëì„ ë•Œë¥¼ ë§í•œë‹¤. ì €ë„ì€ íŒŒì¼ì— ë¡œê¹…í•˜ëŠ” í–‰ìœ„ì´ë¯€ë¡œ, í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë˜ê±°ë‚˜
> ì¥ì• ë¥¼ ì¼ìœ¼ì¼°ì„ ì‹œì—ë„ ì˜ì†ì ì´ë‹¤. ê·¸ë¦¬ê³  í•˜ë‚˜ê°€ ì•„ë‹Œ mongod ì„œë²„ê°€(ë ˆí”Œë¦¬ì¹´ ì…‹ì˜ ê²½ìš°ì™€ ê°™ì´) ì‹¤í–‰ì¤‘ì¼ ê²½ìš°, íˆ¬í‘œ ë©¤ë²„ ì¤‘
> ê³¼ë°˜ ìˆ˜ì˜ ë…¸ë“œì˜ ì €ë„ì— í•´ë‹¹ ê²°ê³¼ê°€ ê¸°ë¡ë˜ì—ˆì„ ë–„ ì˜ì†ì ì´ë¼ê³  í•œë‹¤.

> ğŸ’¡ ë‹¤ì¤‘ ë¬¸ì„œ íŠ¸ëœì­ì…˜ì´ ì›ìì ì´ì§€ë§Œ, ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì•˜ìŒì—ë„ ì½í ìˆ˜ ìˆëŠ”ë°,
> ì˜ˆì™¸ì˜ ê²½ìš°ê°€ ì¡´ì¬í•˜ëŠ”ë°, ì—¬ëŸ¬ ìƒ¤ë“œ ìƒì—ì„œ íŠ¸ëœì­ì…˜ì´ ì§„í–‰ ì¤‘ì´ê³ , ì“°ê¸° ì‘ì—… `w1`, `w2`ê°€ ìˆì„ ê²½ìš°
> ê° ì“°ê¸° ì‘ì—…ì€ ìƒ¤ë“œ `s1`, `s2`ì—ì„œ ì‹¤í–‰ëœë‹¤. ì´ ê²½ìš° í´ë¼ì´ì–¸íŠ¸ì˜ ì½ê¸° ê³ ë ¤ ì„¤ì •ì´
> `local` í˜¹ì€ `available`ë¡œ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ s1, s2 ë‘˜ ì¤‘ í•œ ê³³ë§Œ ì“°ê¸° ì—°ì‚°ì´
> ì™„ë£Œë˜ì–´ë„ ì“°ê¸° ì‘ì—…ì˜ ê²°ê³¼ê°€ ë°˜ì˜ëœ ë°ì´í„°ë¥¼ ì½ì–´ì˜¬ ìˆ˜ ìˆë‹¤.

2. Read Uncommited And Single Document Write

   ë‹¨ì¼ ë¬¸ì„œì— ëŒ€í•œ ì“°ê¸° ëª…ë ¹ì€ ì›ìì ì¸ ì—°ì‚°ì„ ë³´ì¥í•œë‹¤. ê·¸ëŸ¬ë‚˜ í•˜ì§ ì €ë„ì— ê¸°ë¡ë˜ì§€ ì „ì˜ ë°ì´í„°,
   ê·¸ëŸ¬ë‹ˆê¹Œ ì˜ì†ì ì´ì§€ ì•Šì€ ë°ì´í„°ê°€ ë³´ì¼ ìˆ˜ ìˆëŠ” ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤.

3. Read Uncommitted And Multiple Document Write

   `db.collection.updateMany()` ì²˜ëŸ¼ ì—¬ëŸ¬ ë¬¸ì„œë¥¼ ìˆ˜ì •í•˜ëŠ” ì“°ê¸° ì—°ì‚°ì˜ ê²½ìš° ê°
   ë„íë¨¼íŠ¸ì— ëŒ€í•œ ë³€ê²½ì€ ì›ìì ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ì „ì²´ ì—°ì‚°ì€ ì›ìì ì´ì§€ ì•Šë‹¤.
   ì—¬ëŸ¬ ë„íë¨¼íŠ¸ì— ëŒ€í•œ ì—°ì‚°ì€ ë‹¨ì¼ ë¬¸ì„œ ì“°ê¸° ì‘ì—…ì´ë“  ë‹¤ì¤‘ ë¬¸ì„œ ì“°ê¸° ì‘ì—…ì´ë“  ìƒê´€ ì—†ì´
   ë‹¤ë¥¸ ì“°ê¸° ì‘ì—…ì´ ì¤‘ê°„ì— ë¼ì–´ë“¤ ìˆ˜ ìˆë‹¤.

### Causal Consistency ì¸ê´€ ì¼ê´€ì„±

ì´ì „ì— ì¼ì–´ë‚œ ëª…ë ¹ì´ ì´í›„ì— ì¼ì–´ë‚œ ëª…ë ¹ê³¼ ì¸ê³¼ê´€ê³„ê°€ ìˆì„ ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ ë°ì´í„°ì˜ ì‚­ì œ ì‘ì—… ì´í›„ í•´ë‹¹ ì‚­ì œëœ ìœ ì €ì˜ ê°œì¸ì •ë³´ê°€ ì˜ ì‚­ì œëëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²½ìš°ê°€ ê·¸ëŸ¬í•˜ë‹¤.

ëª½ê³ DB 3.6 ë²„ì „ë¶€í„° ì¸ê³¼ ì¼ê´€ì„±ì„ ì œê³µí•˜ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ ì„¸ì…˜ ê¸°ëŠ¥ì„ ì¶”ê°€í–ˆë‹¤.
í•´ë‹¹ ê¸°ëŠ¥ì€ `readConcern`ì´ `majority`ì¸ ì½ê¸° ëª…ë ¹ê³¼ `writeConcern`ì´ `majority`ì¸ ì“°ê¸° ëª…ë ¹ê°„ì˜ ìˆœì„œë¥¼ ë³´ì¥í•´ì¤€ë‹¤.
ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ë™ì‹œì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œí•œ í´ë¼ì´ì–¸íŠ¸ ì„¸ì…˜ë‚´ì—ì„œ ëª…ë ¹ë“¤ì´ ì‹¤í–‰ë  ìˆ˜ ìˆê²Œë” ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

> ğŸ’¡ ì¸ê³¼ ì¼ê´€ ì„¸ì…˜ ë‚´ì˜ ì‘ì—…ì€ ì™¸ë¶€ ì‘ì—… ì‚¬í•­ê³¼ ê²©ë¦¬ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì„¸ì…˜ ì™¸ë¶€ì˜ ì“°ê¸° ì‘ì—…ì´ ì„¸ì…˜ ë‚´ë¶€ ì‘ì—…ì˜ ì‚¬ì´ì—
> ë¼ì–´ë“¤ ê²½ìš° ì´í›„ì— ì§„í–‰ë˜ëŠ” ì½ê¸° ì‘ì—…ì´ ì™¸ë¶€ ì“°ê¸° ì‘ì—…ì˜ ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê²°ë¡ 

ëª½ê³ ë””ë¹„ëŠ” `readConcern`ê³¼ `writeConcern` ì˜µì…˜ì„ ì‚¬ìš©í•´
`Read Uncommited`ì™€ `Read Commited`, `Repeatable Read` ê²©ë¦¬ ë ˆë²¨ì„ êµ¬í˜„í•  ìˆœ ìˆì–´ ë³´ì¸ë‹¤. ê·¸ëŸ¬ë‚˜
ì™¸ë¶€ ì‘ì—…ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê¸° ìœ„í•´ `snapshot` ì½ê¸° ê³ ë ¤ëŠ” ì¸ê³¼ ì¼ê´€ì„±ì´ ë³´ì¥ë˜ëŠ” ì„¸ì…˜ì—ì„œëŠ” ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”
íŠ¸ëœì­ì…˜ì´ ìˆë‹¤ë©´ `Repeatble Read`ëŠ” í¬ê¸°í•´ì•¼ ë  ê²ƒ ê°™ë‹¤.

`Searializable` ê²©ë¦¬ ìˆ˜ì¤€ì€ WritedTiger ì—”ì§„ì˜ ê°€ì¥ ê°•í•œ ê²©ë¦¬ ìˆ˜ì¤€ì¸ `snapshot`ì´ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì‹¤í–‰ ê°€ëŠ¥í•¨ì„ ë³´ì¥í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤.
ì¦‰, T1ì´ ì‹¤í–‰ë˜ê³  T2ê°€ ì‹¤í–‰ë˜ëŠ” ìˆœì„œ, T2ì´ ì‹¤í–‰ë˜ê³  T1ê°€ ì‹¤í–‰ë¨ì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤.

> Snapshot isolation is a strong guarantee, but not equivalent to a single-threaded execution of the transactions, known as serializable isolation. Concurrent transactions T1 and T2 running under snapshot isolation may both commit and produce a state that neither (T1 followed by T2) nor (T2 followed by T1) could have produced, if there is overlap between T1's reads and T2's writes, and between T1's writes and T2's reads.

ìµœê·¼ì— ì§„í–‰í•˜ë˜ í”„ë¡œì íŠ¸ë“¤ì—ì„œ MongoDBì˜ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì˜ ìœ ì—°í•¨ì„ ì´ìœ ë¡œ ì´ˆê¸° ë°ì´í„°ë² ì´ìŠ¤ë¡œ ê²°ì •í•˜ì—¬ ì§„í–‰í•˜ì˜€ì—ˆëŠ”ë°, ê°œë°œì˜ ì†ë„ì™€ í¸ë¦¬í•¨ë§Œì„ ì´ìœ ë¡œ ê²°ì •í•˜ê¸°ì—” ë¦¬ìŠ¤í¬ê°€ ë§ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤. íšŒì› ì •ë³´ ê´€ë ¨ ê¸°ëŠ¥, ê²°ì œ ê´€ë ¨ ê¸°ëŠ¥ì˜ ê²½ìš°
ìˆœì„œë¥¼ ë³´ì¥í•´ì•¼ í•  ê²½ìš°ê°€ ë§ì€ë° ì´ ê²½ìš°ë¥¼ ìƒê°í•˜ë©´ RDB ê¸°ë°˜ìœ¼ë¡œ DBë¥¼ êµ¬ì¶•í•˜ê³  ì¶”í›„ì— ë¡œê·¸ì„± ë°ì´í„°ë“¤ì„ MongoDBë¡œ ì´ê´€í•˜ëŠ”ê²Œ ì¢‹ì•„ ë³´ì¸ë‹¤. ë¬¼ë¡  RDBì˜ ìŠ¤í‚¤ë§ˆëŠ” ì—„ê²©í•˜ê¸° ë•Œë¬¸ì— ë¹„ì¦ˆë‹ˆìŠ¤ê°€ í™•ì¥í•´ ë‚˜ê°€ë©´ì„œ
í™•ì¥í•˜ê¸° ì‰½ê²Œë” ì´ˆê¸° RDB ì„¤ê³„ ì‹œ ìŠ¤í‚¤ë§ˆ í™•ì¥ì´ ìš©ì´í•˜ê²Œ ì •ê·œí™”ë¥¼ ì˜ ì§„í–‰í•´ë†“ì„ í•„ìš”ê°€ ìˆì–´ ë³´ì¸ë‹¤.

# ì°¸ì¡°

- [ìœ„í‚¤ë°±ê³¼ - ë‚™ê´€ì  ë³‘í–‰ ìˆ˜í–‰ ì œì–´](https://ko.wikipedia.org/wiki/%EB%82%99%EA%B4%80%EC%A0%81_%EB%B3%91%ED%96%89_%EC%88%98%ED%96%89_%EC%A0%9C%EC%96%B4)
- [ë°ì´í„°ë² ì´ìŠ¤ ë½](https://medium.com/inspiredbrilliance/what-are-database-locks-1aff9117c290)
- [MongoDB ë™ì‹œì„± ì œì–´ ë¬¸ì„œ](https://www.mongodb.com/docs/v4.4/reference/glossary/#std-term-concurrency-control)
- [MongoDB ì“°ê¸° ì‘ì—…ê³¼ ì›ìì„± ë¬¸ì„œ](https://www.mongodb.com/docs/manual/core/write-operations-atomicity/#update-if-current)
- [WiredTiger íŠ¸ëœì­ì…˜ ê´€ë ¨ ê³µì‹ ë¬¸ì„œ](https://source.wiredtiger.com/2.5.2/transactions.html)
- [MongoDB íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì— ëŒ€í•œ ì»¤ë®¤ë‹ˆí‹° ë‚´ ì§ˆë¬¸/ë‹µë³€ ê¸€](https://www.mongodb.com/community/forums/t/isolation-in-transactions/158235)
