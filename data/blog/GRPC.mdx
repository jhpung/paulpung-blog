---
title: gRPC
date: '2023-04-10'
tags: ['gRPC']
draft: true
summary: 'ν”„λ΅μ„Έμ¤ κ°„ μ›κ²© νΈμ¶μ„ νΈλ¦¬ν•κ² ν•΄μ£Όλ” gRPCμ— λ€ν•΄ μ•μ•„λ³΄μ!'
---

## gRPC

- RPCμ€ Remote Process Callμ μ•½μλ΅ ν•΄λ‹Ή κΈ°μ μ΄ μ–΄λ–¤ κΈ°μ μΈμ§€ ν• λ‹¨μ–΄λ΅ μ•λ ¤μ¤€λ‹¤.
- "λ§¤κ°λ³€μ, λ°ν™ νƒ€μ…κ³Ό ν•¨κ» μ›κ²©μΌλ΅ ν•¨μλ¥Ό νΈμ¶ ν•  μ μλ‹¤λ©΄?"
- ν”„λ΅ν† μ½ λ²„νΌ
  - gRPCμ μΈν„°νμ΄μ¤ μ •μ μ–Έμ–΄λ‚ λ©”μ‹μ§€ κµν™ ν•μ‹μΌλ΅ μ“°μΈλ‹¤.
- μ„λ²„ μ–΄ν”λ¦¬μΌ€μ΄μ…μ λ©”μ†λ“λ¥Ό μ§μ ‘ νΈμ¶ ν•  μ μκ² ν•΄μ¤€λ‹¤.
- λ¶„μ‚° μ–΄ν”λ¦¬μΌ€μ΄μ…, μ„λΉ„μ¤λ¥Ό λ§λ“¤κΈ° μ‰½κ² ν•΄μ¤€λ‹¤.
- μ„λ²„ μΈ΅μ—μ„  μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•κ³  gRPC μ„λ²„λ¥Ό κµ¬λ™μ‹μΌ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈμ—μ„λ” μ„λ²„μ™€ λ‘κ°™μ€ λ©”μ†λ“λ¥Ό μ κ³µν•λ‹¤. μ΄λ¥Ό Stub νΉμ€ ClientλΌκ³  ν•λ‹¤.
- gRPC ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” λ‹¤μ–‘ν• ν™κ²½μ—μ„ (μλ°”μ™€ Node.js μ–΄ν”λ¦¬μΌ€μ΄μ…) μ„λ΅ ν†µμ‹ ν•  μ μκ² ν•΄μ¤€λ‹¤.

![gRPC κ·Έλ¦Ό](https://grpc.io/img/landing-2.svg)

## ν”„λ΅ν† μ½ λ²„νΌ

- ν”„λ΅ν† μ½ λ²„νΌλ” gRPCκ°€ κΈ°λ³ΈμΌλ΅ μ‚¬μ©ν•κ² μ„Έν…λμ–΄ μλ‹¤.
- ν”„λ΅ν† μ½ λ²„νΌλ” κµ¬μ΅°ν™”λ λ°μ΄ν„°λ¥Ό μ§λ ¬ν™”ν•κΈ° μ„ν•΄ μ–Έμ–΄μ— μΆ…μ†μ μ΄μ§€ μ•κ³ ,
  ν”λ«νΌμ— κµ¬μ• λ°›μ§€ μ•λ” ν™•μ¥ κ°€λ¥ν• λ©”μ»¤λ‹μ¦μ…λ‹λ‹¤.
- ν”„λ΅ν† μ½ λ²„νΌλ¥Ό μ‚¬μ©ν•λ” μ²« λ‹¨κ³„λ” μ§λ ¬ν™”ν•κ³ μ ν•λ” λ°μ΄ν„°μ κµ¬μ΅°λ¥Ό μ •μν•λ” κ²ƒμ΄λ‹¤.
- `.proto` νμΌ ν™•μ¥μλ¥Ό μ‚¬μ©ν•μ—¬ μ •μν•λ‹¤.
- λ°μ΄ν„°λ” λ©”μ‹μ§€λ΅ κµ¬μ΅°ν™”λλ‹¤.
- μ΄λ¦„ - κ°’ κµ¬μ΅°μ ν•„λ“λ“¤μ„ ν¬ν•¨ν• λ…Όλ¦¬μ  λ μ½”λ“λ“¤μ„ λ©”μ‹μ§€λΌκ³  ν•λ‹¤.

  ### μμ‹

  ```
  message Person {
    string name = 1;
    int32 id = 2;
    bool has_ponycopter = 3;
  }
  ```

- ν”„λ΅ν† μ½ λ²„νΌ μ»΄νμΌλ¬ `protoc` λ¥Ό μ‚¬μ©ν•΄ μ›ν•λ” μ–Έμ–΄λ΅ λ°μ΄ν„° μ ‘κ·Ό ν΄λμ¤λ¥Ό λ§λ“ λ‹¤.
- `protoc`λ” `Person` ν΄λμ¤λ¥Ό λ§λ“¤κ³  ν•΄λ‹Ή ν΄λμ¤λ” λ°μ΄ν„° μ ‘κ·Ό, μ§λ ¬ν™”, ν”„λ΅ν† μ½ λ²„νΌ λ©”μ‹μ§€ μμ‹  λ“±μ— μ“Έ μ μλ‹¤.

## gRPC μ„λΉ„μ¤

- `.proto` νμΌ ν™•μ¥μμΈ νμΌ μ•μ— gRPC μ„λΉ„μ¤λ¥Ό μ •μν•  μ μλ‹¤.
- μμ‹

  ```
  // Greeter μ„λΉ„μ¤μ μ •μλ‹¤.
  // HelloRequest νƒ€μ…μ„ μΈμλ΅ λ°›κ³ , HelloReply νƒ€μ…μ„ λ°ν™ν•λ” SayHello λ©”μ†λ“κ°€ μ •μλμ–΄ μλ‹¤.
  service Greeter {
    // μ„λ²„λ΅ μ”μ²­μ„ λ³΄λ‚΄λ” λ©”μ†λ“λ‹¤.
    rpc SayHello (HelloRequest) returns (HelloReply) {}
  }

  // μ”μ²­μ—λ” name ν•„λ“λ¥Ό ν¬ν•¨ν•λ‹¤.
  message HelloRequest {
    string name = 1;
  }

  // μ‘λ‹µμ—λ” messageκ°€ ν¬ν•¨λμ–΄ μ¨λ‹¤.
  message HelloReply {
    string message = 1;
  }
  ```

- gRPCλ” ν”„λ΅ν†  νμΌλ“¤μ—μ„ μ½”λ“λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ `protoc` μ»΄νμΌλ¬λ¥Ό μ‚¬μ©ν•λ‹¤.

### gRPC μ„λΉ„μ¤ λ©”μ†λ“

- Unary RPC

  ν΄λΌμ΄μ–ΈνΈκ°€ ν•λ‚μ μ”μ²­μ„ λ³΄λ‚΄κ³  μ„λ²„λ” ν•λ‚μ μ”μ²­μ„ λ³΄λ‚Έλ‹¤.

- Server Streaming RPC

  ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­μ„ λ³΄λ‚΄λ©΄ μ„λ²„λ” μ‘λ‹µ λ©”μ‹μ§€ μ‹ν€€μ¤λ¥Ό μ½κΈ° μ„ν• μ¤νΈλ¦Όμ„ λ°ν™λ°›λ”λ‹¤.
  ν΄λΌμ΄μ–ΈνΈλ” λ” μ΄μƒ λ©”μ‹μ§€κ°€ μ—†μ„ λ•κΉμ§€ μ¤νΈλ¦Όμ„ μ½λ”λ‹¤.

  - gRPCλ” λ…λ¦½λ RPC μ”μ²­λ§λ‹¤ λ©”μ‹μ§€μ μμ„λ¥Ό λ³΄μ¥ν•λ‹¤.

- Client Streaming RPC

  ν΄λΌμ΄μ–ΈνΈκ°€ μ κ³µλ μ¤νΈλ¦ΌμΌλ΅ μ‘μ„±ν• λ©”μ‹μ§€ μ‹ν€€μ¤λ¥Ό μ „μ†΅ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈκ°€ λ©”μ‹μ§€ μ‘μ„±μ„ μ™„λ£ν•λ©΄
  μ„λ²„κ°€ ν•΄λ‹Ή λ©”μ‹μ§€ μ‹ν€€μ¤λ¥Ό μ½κ³  μ‘λ‹µμ„ λ³΄λ‚Ό λ•κΉμ§€ κΈ°λ‹¤λ¦°λ‹¤. **Server Streaming RPC**μ™€ λ§μ°¬κ°€μ§€λ΅
  λ©”μ‹μ§€μ μμ„λ¥Ό λ³΄μ¥ν•λ‹¤.

- Bidirectional Streaming RPC

  ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μΈ΅ λ¨λ‘ read/write μ¤νΈλ¦Όμ„ ν†µν•΄ λ©”μ‹μ§€ μ‹ν€€μ¤λ¥Ό μ „μ†΅ν•λ‹¤. λ‘ μ¤νΈλ¦Όμ€ λ…λ¦½μ μΌλ΅ λ™μ‘ν•λ‹¤.
  κ·Έλ¬λ―€λ΅ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μμ„κ°€ μ–΄λ–»λ“  μ½κΈ° μ“°κΈ°κ°€ κ°€λ¥ν•λ‹¤. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ¨λ“  λ©”μ‹μ§€κ°€ μ¨ ν›„ μ‘λ‹µμ„ μ „μ†΅ν•  μ μκ³ 
  κ° λ©”μ‹μ§€κ°€ λ„μ°©ν•  λ•λ§λ‹¤ μ‘λ‹µμ„ μ „μ†΅ν•  μλ„ μλ‹¤.

## API

ν”„λ΅ν† μ½ λ²„νΌ μ»΄νμΌλ¬λ” `.proto` νμΌμ μ„λΉ„μ¤ μ •μμ— λ”°λΌ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ μ½”λ“λ¥Ό μƒμ„±ν•΄μ¤€λ‹¤.
gRPC μ‚¬μ©μλ” APIλ¥Ό μ‚¬μ©ν•΄ ν•΄λ‹Ή μ½”λ“λ¥Ό νΈμ¶ν•κΈ°λ§ ν•λ©΄ λλ‹¤. μ΄λ” μ–Έμ–΄κ°€ λ‹¤λ¥΄λ”λΌκ³  APIλ¥Ό μ‚¬μ©ν•μ—¬ ν†µμ‹ ν•κΈ° λ•λ¬Έμ—
μ—¬λ¬ μ–Έμ–΄κ°„μ—λ„ μ‚¬μ©ν•  μ μλ‹¤. gRPCλ¥Ό μ§€μ›ν•λ” μ–Έμ–΄λ“¤μ€ λ‹¤μκ³Ό κ°™λ‹¤.

- C# / .NET
- C++
- Dart
- Go
- Java
- Kotlin
- Node
- Objective-C
- PHP
- Python
- Ruby

ν•΄λ‹Ή μ–Έμ–΄λ“¤μ€ `.proto` νμΌκ³Ό μ»΄νμΌλ¬λ§ μλ‹¤λ©΄ ν•΄λ‹Ή μ–Έμ–΄μ— λ§λ” μ½”λ“λ¥Ό μλ™ μƒμ„±ν•΄μ¤€λ‹¤. π²

### μ„λ²„μ κµ¬λ™ κ³Όμ •

1. `.proto` νμΌμ„ ν”„λ΅ν† μ½ λ²„νΌλ΅ μ»΄νμΌν•μ—¬ μ½”λ“λ¥Ό μƒμ„±ν•λ‹¤.
2. μ„λ²„λ” μ„λΉ„μ¤μ— μ •μλ λ©”μ†λ“λ¥Ό κµ¬ν„ν•λ‹¤.
3. gRPC μ„λ²„λ¥Ό κµ¬λ™ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•λ‹¤.

### ν΄λΌμ΄μ–ΈνΈμ κµ¬λ™ κ³Όμ •

1. ν΄λΌμ΄μ–ΈνΈλ” `stub` νΉμ€ `client`λ΅ μ•λ ¤μ§„ λ΅μ»¬ κ°μ²΄λ¥Ό κ°€μ§€κ³  μλ‹¤. ν•΄λ‹Ή κ°μ²΄λ” μ„λΉ„μ¤ μ •μ
   λ‚΄μ— μλ” λ©”μ†λ“λ¥Ό κµ¬ν„ν•λ‹¤.
2. ν΄λΌμ΄μ–ΈνΈλ” λ΅μ»¬ κ°μ²΄μ— μ΅΄μ¬ν•λ” λ©”μ†λ“λ¥Ό νΈμ¶ν•κΈ°λ§ ν•λ©΄ λλ‹¤.

λ‚λ¨Έμ§€ μƒμ„Έν• λ™μ‘λ“¤μ€ ν”„λ΅ν† μ½ λ²„νΌκ°€ μ•μ•„μ„ μ²λ¦¬ν•΄μ¤€λ‹¤. μλ¥Ό λ“¤λ©΄ λ©”μ‹μ§€μ μΈμ½”λ”©/λ””μ½”λ”©, λ©”μ†λ“ μ‹¤ν–‰ λ“±μ΄ κ·Έλ ‡λ‹¤.

## HTTPμ™€μ λΉ„κµ

| κΈ°λ¥                 | gRPC                 | JSONμ„ μ‚¬μ©ν•λ” HTTP API        |
| -------------------- | -------------------- | ------------------------------- | ------------- |
| κ³„μ•½                 | ν•„μ(.proto)         | μ„ νƒ                            | μ‚¬ν•­(OpenAPI) |
| ν”„λ΅ν† μ½             | HTTP/2               | HTTP                            |
| Payload              | Protobuf(μ†ν•,μ΄μ§„)  | JSON(λ€ν•, μ‚¬λμ΄ μ½μ„ μ μμ) |
| κ·λ²”                 | μ—„κ²©ν• μ‚¬μ–‘          | λμ¨ν•¨. λ¨λ“  HTTPκ°€ μ ν¨ν•©λ‹λ‹¤. |
| μ¤νΈλ¦¬λ°             | ν΄λΌμ΄μ–ΈνΈ, μ„λ²„,    | μ–‘λ°©ν–¥ ν΄λΌμ΄μ–ΈνΈ, μ„λ²„         |
| λΈλΌμ°μ € μ§€μ›        | μ•„λ‹μ”(gRPC-μ›Ή ν•„μ”) | μ                              |
| λ³΄μ•                 | μ „μ†΅(TLS)            | μ „μ†΅(TLS)                       |
| ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μƒμ„± | μ                   | OpenAPI + νƒ€μ‚¬ λ„κµ¬             |

## μ¥μ 

- gRPC λ©”μ‹μ§€ μ΄μ§„ λ°μ΄ν„°λ΅ μ§λ ¬ν™”λμ–΄ μ©λ‰μ΄ μ‘λ‹¤.
- HTTP/2 μ „μ©μΌλ΅ μ„¤κ³„λμ–΄ HTTP1.x λ²„μ „μ— λΉ„ν•΄ λ°μ „λ μ„±λ¥μ„ μ κ³µν•λ‹¤.
- λ‹¨μΌ TCP μ—°κ²°λ³΄λ‹¤ μ—¬λ¬ HTTP/2 νΈμ¶μ λ©€ν‹°ν”λ ‰μ‹±(ν•λ‚μ μ „μ†΅λ΅λ¥Ό μ—¬λ¬ μ‚¬μ©μκ°€ λ™μ‹μ— μ‚¬μ©ν•΄ ν¨μ¨μ„±μ„ κ·Ήλ€ν™” ν•λ” κ²ƒ)
  μ΄λ” [HOL λΈ”λ΅ν‚Ή](https://en.wikipedia.org/wiki/Head-of-line_blocking) λ¬Έμ λ¥Ό ν•΄κ²°ν•λ‹¤.
- μ½”λ“ μƒμ„±λ¥Ό κΈ°λ¥μ΄ μμΌλ―€λ΅ κ°λ° μƒμ‚°μ„±μ΄ μ¬λΌκ°„λ‹¤.
- μ¤ν™μ΄ μƒμ„Έν•κ² μ •ν•΄μ Έ μμ–΄μ„ HTTPλ¥Ό μ‚¬μ©ν• APIμ„ κµ¬ν„ν•  λ•λ³΄λ‹¤ λ¶ν•„μ”ν• λ…Όμ μ‹κ°„μ΄ μ μ•½λλ‹¤.

μ„ νΉμ§•λ“¤μ„ κ³ λ ¤ν•΄μ„ gRPCλ” μ„±λ¥, ν¨μ¨μ„±μ΄ μ¤‘μ”ν• κ²½λ‰ λ§μ΄ν¬λ΅μ„λΉ„μ¤, μΆ…λ‹¨κ°„ μ‹¤μ‹κ°„ ν†µμ‹  λ“¤μ— μ“°μ΄κ³ , ν”„λ΅μ„Έμ¤κ°„ ν†µμ‹ μ—λ„ μ“°μΌ μ μλ‹¤.

## λ‹¨μ 

- λΈλΌμ°μ €μ—μ„ gRPC μ„λΉ„μ¤λ¥Ό μ§μ ‘ νΈμ¶ν•λ”κ±΄ λ¶κ°€λ¥ν•λ‹¤.
  - λΈλΌμ°μ €μ—μ„ μ•΅μ„Έμ¤ν•λ ¤λ©΄ μ• λ‹¨μ— μ„λ²„λ¥Ό ν”„λ΅μ‹λ΅ λ‘μ–΄μ•Ό ν•λ‹¤. μ¦‰, ν΄λΌμ΄μ–ΈνΈ -> μ„λ²„ -> gRPC κµ¬μ΅°μ΄λ‹¤.
- λ©”μ‹μ§€λ¥Ό μ‚¬λμ΄ μ½μ„ μ μ—†λ‹¤.
  - λ©”μ‹μ§€λ¥Ό μ—­μ§λ ¬ν™” ν•κΈ° μ„ν• λ„κµ¬κ°€ ν•„μ”ν•λ‹¤. HTTP/1.x μ κ²½μ° JSONμ€ μ‚¬λμ΄ μ½μ„ μ μλ” ν•μ‹μ΄κΈ° λ•λ¬Έμ— λ”°λ΅ λ„κµ¬κ°€ ν•„μμ μ΄μ§„ μ•λ‹¤.
- λΈλ΅λ“μΊμ¤νΈκ°€ λ¶κ°€λ¥ν•λ‹¤.
  - μΆ…λ‹¨κ°„ μ‹¤μ‹κ°„ ν†µμ‹ λ§ μ§€μ›ν•λ―€λ΅ μ±„ν…λ°©μ΄ μκ³  ν•΄λ‹Ή λ°©μ— μλ” λ¨λ“  μ‚¬λμ—κ² λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•΄μ•Ό ν•λ” μƒν™©μ—μ„  λ‹¤λ¥Έ ν”„λ μ„μ›ν¬λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

### μ°Έκ³ 

- What is gRPC? - https://grpc.io/docs/what-is-grpc/introduction/
- gRPCμ™€ HTTP λΉ„κµ - https://learn.microsoft.com/ko-kr/aspnet/core/grpc/comparison?view=aspnetcore-7.0
